services:
    app:
        image: dokkaner/teemii-frontend:develop
        ports:
            - "8080:80"
        networks:
            - teemii-network
        environment:
        - VITE_APP_TITLE=Teemii
        - VITE_APP_PORT=80
#        depends_on:
#            db:
#                condition: service_healthy
    
    db:
        image: dokkaner/teemii-backend:develop
        volumes:
            - teemii-data:/data
        networks:
            - teemii-network 
        ports:
            - 3000:3000
        environment:
        - EXPRESS_PORT=3000
        - SOCKET_IO_PORT=1555
#        healthcheck:
#            test: ["CMD", "db_OK"]
#            interval: 1m30s
#            timeout: 30s
#            retries: 5
#            start_period: 30s


volumes:
    teemii-data:
        name: teemii-data
networks:
    teemii-network:
        name: teemii-network
        driver: bridge